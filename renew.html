<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/renew.styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">

    <link rel="icon" href="../images/logo.png" type="image/x-icon">
    <link rel="shortcut icon" href="path/to/logo.ico" type="image/x-icon">
    <title>DriveSure</title>
</head>
<body>
    <header class="bg-light p-3">
        <nav class="navbar navbar-expand-lg navbar-light container">
            <a class="navbar-brand" href="#">DriveSure</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Services</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Contact</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="login.php">Login</a>
                    </li>
                </ul>
            </div>
        </nav>
    </header>

    <section class="renewpolicysec bg-primary py-5 text-center">
        <div class="container">
            <h3 class="text-white display-4">RENEW POLICY</h3>
        </div>
    </section>

    <section class="py-5 bg-info bg-opacity-25" style="min-height: 65vh;">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <div class="thirdparty p-3">
                        <h4>Third Party</h4>
                        <p>A third-party car insurance is the most common type of vehicle insurance.<br>
                            It covers only the damages &amp; losses caused to a third-party vehicle,<br>
                            property or person in the event of an accident.</p>
                    </div>
                    <div class="make p-3 mt-3">
                        <h4>Make Your Own</h4>
                        <p>Fairfirst Insurance's unique Ã  la carte policy allows you to cover selected<br>
                            parts of your vehicle only. Pick and pay for only the parts which you'd like to cover!</p>
                    </div>
                    <div class="full p-3 mt-3">
                        <h4>Full Option</h4>
                        <p>In case you meet with an accident where the repair cost of your vehicle exceeds <br>
                            its insured value, you will receive the total insured value of your vehicle as your claim.</p>
                    </div>
                </div>
                <div class="col-md-6 d-flex justify-content-end">
                    <video autoplay loop muted src="../images/Auto Insurance Animated Video.mp4" class="img-fluid rounded shadow" style="max-width: 100%; height: auto;"></video>
                </div>
            </div>
        </div>
    </section>

    <hr class="border border-dark border-1 opacity-50 my-4">

    <section id="sec2" class="py-5 bg-primary text-white">
        <div class="container">
            <div class="currentdis">
                <div class="policyId mb-4">
                    <form id="searchPolicyForm">
                        <div class="mb-3">
                            <label for="policyIdInput" class="form-label">INPUT YOUR POLICY ID:</label>
                            <div class="input-group">
                                <input type="text" class="form-control" id="policyIdInput" name="policyId" aria-describedby="searchButton">
                                <button class="btn btn-light" type="submit" id="searchButton">Search</button>
                            </div>
                            <div id="policyIdError" class="form-text text-warning"></div>
                        </div>
                    </form>
                </div>

                <div class="table1" id="policyDetailsDisplay" style="display: none;">
                    <h5 class="mb-3">Policy Details</h5>
                    <table class="table table-bordered table-light">
                        <tbody>
                            <tr>
                                <th>Policy ID:</th>
                                <td id="displayPolicyId"></td>
                            </tr>
                            <tr>
                                <th>Vehicle ID:</th>
                                <td id="displayVehicleId"></td>
                            </tr>
                            <tr>
                                <th>Coverage:</th>
                                <td id="displayCoverage"></td>
                            </tr>
                            <tr>
                                <th>Expire Date:</th>
                                <td id="displayExpireDate"></td>
                            </tr>
                        </tbody>
                    </table>
                    <div id="noDataMessage" class="alert alert-warning mt-3" style="display: none;">No Data found for that policy ID</div>
                </div>
            </div>
        </div>
    </section>

    <section class="py-4 bg-secondary text-white text-center">
        <div class="container">
            <div>
                <h2>Do you want to renew your Current insurance? <br>
                    Now You Can Renew Your policy Easily</h2>
            </div>
        </div>
    </section>

    <section class="py-5 bg-light">
        <div class="container">
            <form id="renewPolicyForm" action="includes/renew.inc.php" method="POST">
                <div class="policy">
                    <div class="mb-3">
                        <label for="renewPolicyId" class="form-label">Your Policy ID:</label>
                        <input type="text" class="form-control" id="renewPolicyId" name="policyId" value="" readonly>
                    </div>
                    <div class="mb-3">
                        <label for="coverageSelect" class="form-label">Select Your Package:</label>
                        <select class="form-select" name="coverage" id="coverageSelect">
                            <option value="Third Party" data-price-multiplier="1">Third Party</option>
                            <option value="Make_Your_Own" data-price-multiplier="1.5">Make Your Own</option>
                            <option value="Full Option" data-price-multiplier="2">Full Option</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="durationSelect" class="form-label">Select Duration:</label>
                        <select class="form-select" name="months" id="durationSelect">
                            <option value="6_MONTHS" data-price-multiplier="0.6">6 MONTHS</option>
                            <option value="12_MONTHS" data-price-multiplier="1">12 MONTHS</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="renewVehicleId" class="form-label">Vehicle ID:</label>
                        <input type="text" class="form-control" id="renewVehicleId" name="vehicleID" value="" readonly>
                    </div>
                    <input type="hidden" name="payAmount" id="totalAmount" value="">
                </div>
            </form>
        </div>
    </section>

    <hr class="border border-dark border-1 opacity-50 my-0">

    <section class="py-4 bg-secondary text-white text-center">
        <div class="container">
            <div>
                Your Total Amount Is: <span id="totalAmountDisplay"></span>
            </div>
            <button type="submit" form="renewPolicyForm" class="btn btn-light mt-3" name="submit">Pay Now</button>
        </div>
    </section>

    <footer class="bg-light py-3 mt-5 text-center">
        <p>&copy; 2025 DriveSure. All rights reserved.</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
    <script>
        $(document).ready(function() {
            $("#searchPolicyForm").submit(function(event) {
                event.preventDefault();
                const policyId = $("#policyIdInput").val().trim();
                if (policyId === "") {
                    $("#policyIdError").text("Please enter your Policy ID.");
                    $("#policyDetailsDisplay").hide();
                    $("#noDataMessage").hide();
                    return;
                } else {
                    $("#policyIdError").text("");
                }

                // Simulate AJAX call to fetch policy details (replace with your actual API endpoint)
                $.ajax({
                    url: 'includes/get_policy_details.php', // Replace with your actual API endpoint
                    type: 'POST',
                    data: { policyId: policyId },
                    dataType: 'json',
                    success: function(data) {
                        if (data && data.PolicyID) {
                            $("#displayPolicyId").text(data.PolicyID);
                            $("#displayVehicleId").text(data.VehicleID);
                            $("#displayCoverage").text(data.Coverage);
                            $("#displayExpireDate").text(data.ExpireDate || 'N/A'); // Adjust key if needed
                            $("#renewPolicyId").val(data.PolicyID);
                            $("#renewVehicleId").val(data.VehicleID);
                            $("#policyDetailsDisplay").show();
                            $("#noDataMessage").hide();
                            calculateTotalAmount(); // Initial calculation after loading data
                        } else {
                            $("#policyDetailsDisplay").hide();
                            $("#noDataMessage").show();
                        }
                    },
                    error: function(xhr, status, error) {
                        console.error("Error fetching policy details:", error);
                        $("#policyDetailsDisplay").hide();
                        $("#noDataMessage").show();
                    }
                });
            });

            function calculateTotalAmount() {
                const coverageMultiplier = parseFloat($("#coverageSelect option:selected").data("price-multiplier")) || 1;
                const durationMultiplier = parseFloat($("#durationSelect option:selected").data("price-multiplier")) || 1;
                // You'll need a base price or a way to fetch it based on the policy details
                const basePrice = 1000; // Replace with your actual base price logic

                const totalAmount = basePrice * coverageMultiplier * durationMultiplier;
                $("#totalAmountDisplay").text(totalAmount.toFixed(2));
                $("#totalAmount").val(totalAmount.toFixed(2));
            }

            $("#coverageSelect, #durationSelect").change(calculateTotalAmount);
        });
    </script>
</body>
</html>